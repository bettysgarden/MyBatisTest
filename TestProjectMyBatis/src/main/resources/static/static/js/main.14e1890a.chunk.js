(this["webpackJsonpclient-react-tree"]=this["webpackJsonpclient-react-tree"]||[]).push([[0],{15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var d=n(1),r=n.n(d),o=n(9),i=n.n(o),a=(n(15),n(2)),c=n(3),s=n(4),l=new(function(){function e(){Object(c.a)(this,e),this.baseUrl="http://localhost:8181/v1/nodes/"}return Object(s.a)(e,[{key:"getAllNodes",value:function(){return this._rest("",this._getRestOptions("GET"))}},{key:"getRootNodes",value:function(){return this._rest("root",this._getRestOptions("GET"))}},{key:"getNode",value:function(e){return this._rest(e,this._getRestOptions("GET"))}},{key:"getChildren",value:function(e){return this._rest(e+"/children",this._getRestOptions("GET"))}},{key:"updateNode",value:function(e){return this._rest(e.id,this._getRestOptions("PUT",e))}},{key:"addNode",value:function(e){return this._rest("",this._getRestOptions("POST",e))}},{key:"deleteNode",value:function(e){return this._rest(e,this._getRestOptions("DELETE"))}},{key:"_rest",value:function(e,t){var n=this.baseUrl+e;return console.log(">>> ",n,t),fetch(n,t).then(this._status).then(this._json).then(this._log).catch(this._onRestError)}},{key:"_getRestOptions",value:function(e,t){var n={method:e,mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Accept:"application/json"},redirect:"follow",referrerPolicy:"no-referrer"};return void 0!==t&&(n.body=JSON.stringify(t)),n}},{key:"_status",value:function(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(e.statusText))}},{key:"_json",value:function(e){return e.text().then((function(e){return e?JSON.parse(e):{}}))}},{key:"_log",value:function(e){return console.log("<<< ",e),Promise.resolve(e)}},{key:"_onRestError",value:function(e){return Promise.reject(new Error(e))}}]),e}()),h=n(10),u=n(5),j=new(function(){function e(){Object(c.a)(this,e),this.allNodes=[],this.tree=[],this.expandedNodesId=[],this.selectedNodeId=void 0}return Object(s.a)(e,[{key:"_makeTreeNode",value:function(e){return Object(u.a)(Object(u.a)({},e),{},{expanded:this.expandedNodesId.includes(e.id),selected:this.selectedNodeId===e.id,children:[]})}},{key:"_getById",value:function(e,t){var n,d=Object(h.a)(t);try{for(d.s();!(n=d.n()).done;){var r=n.value;if(r.id===e)return r;if(r.children){var o=this._getById(e,r.children);if(o)return o}}}catch(i){d.e(i)}finally{d.f()}}},{key:"_getTreeNode",value:function(e){return this._getById(e,this.tree)}},{key:"setRootNodes",value:function(e){var t=this;this.expandedNodesId=[],this.selectedNodeId=void 0,this.tree=e.map((function(e){return t._makeTreeNode(e)}))}},{key:"getRootTreeNodes",value:function(){return this.tree}},{key:"selectItem",value:function(e){var t=this.getSelectedTreeNode();t&&(t.selected=!1),this.selectedNodeId=e;var n=this.getSelectedTreeNode();n&&(n.selected=!0)}},{key:"togleItem",value:function(e){var t=this._getTreeNode(e);if(t.expanded=!t.expanded,t.expanded)return this.expandedNodesId.push(e),!0;var n=this.expandedNodesId.indexOf(e);return n>-1&&this.expandedNodesId.splice(n,1),t.children=[],!1}},{key:"setChildren",value:function(e,t){var n=this;this._getTreeNode(e).children=t.map((function(e){return n._makeTreeNode(e)}))}},{key:"getSelectedNodeId",value:function(){return this.selectedNodeId}},{key:"getSelectedTreeNode",value:function(){return this._getTreeNode(this.selectedNodeId)}}]),e}()),b="onRefreshAllNodes",p="onItemClicked",v="onExpandClicked",O="onAddRootNodeClicked",S="onAddNodeClicked",x="onEditNodeClicked",f="onDeleteNodeClicked",N="onPopupEditorSaveClicked",m="onPopupEditorCancelClicked",g=new(function(){function e(){Object(c.a)(this,e),this._reset()}return Object(s.a)(e,[{key:"_reset",value:function(){this._updateAllNodesTableState(),this._updateTreeRootState(),this._updateSelectedNodeFormState(),this._updateUIPanelState(),this._updatePopupEditorState()}},{key:"_handler",value:function(e,t){var n=this;switch(console.log("Controller::handler > ",e,t),e){case b:this._updateAllNodesTableState();break;case p:j.selectItem(t),this._setTreeRootState(void 0,!1),this._updateSelectedNodeFormState(),this._updateUIPanelState();break;case v:if(!j.togleItem(t)){this._setTreeRootState(void 0,!1);break}l.getChildren(t).then((function(e){j.setChildren(t,e),n._setTreeRootState(void 0,!1)})).catch((function(e){n._setAllNodesTableState(e,!1)}));break;case O:this._setPopupEditorState(!0,e,{});break;case S:this._setPopupEditorState(!0,e,{parentId:j.getSelectedNodeId()});break;case x:this._setPopupEditorState(!0,e,j.getSelectedTreeNode());break;case f:l.deleteNode(j.getSelectedNodeId()).then((function(){n._reset()})).catch((function(e){throw new Error("Delete node error:"+e.toString())}));break;case N:this.popupEditorState.event===x?l.updateNode(t).then((function(){n._reset()})).catch((function(e){throw new Error("Save node error:"+e.toString())})):this.popupEditorState.event!==S&&this.popupEditorState.event!==O||l.addNode(t).then((function(){n._reset()})).catch((function(e){throw new Error("Add node error:"+e.toString())}));break;case m:this._updatePopupEditorState();break;default:console.warn("Unknown event: name=".concat(e," , data=").concat(t))}}},{key:"getHandler",value:function(){var e=this;return function(t,n){e._handler(t,n)}}},{key:"onAllNodesTableStateChanged",value:function(e){}},{key:"_setAllNodesTableState",value:function(e,t){this.allNodesTableState={error:e,isLoading:t,nodes:j.allNodes},this.onAllNodesTableStateChanged(this.allNodesTableState)}},{key:"_updateAllNodesTableState",value:function(){var e=this;j.allNodes=[],this._setAllNodesTableState(void 0,!0),l.getAllNodes().then((function(t){j.allNodes=t,e._setAllNodesTableState(void 0,!1)})).catch((function(t){e._setAllNodesTableState(t,!1)}))}},{key:"onTreeRootStateChanged",value:function(e){}},{key:"_setTreeRootState",value:function(e,t){this.treeRootState={error:e,isLoading:t,treeNodes:j.getRootTreeNodes()},this.onTreeRootStateChanged(this.treeRootState)}},{key:"_updateTreeRootState",value:function(){var e=this;j.setRootNodes([]),this._setTreeRootState(void 0,!0),l.getRootNodes().then((function(t){j.setRootNodes(t),e._setTreeRootState(void 0,!1)})).catch((function(t){e._setTreeRootState(t,!1)}))}},{key:"onSelectedNodeFormStateChanged",value:function(e){}},{key:"_setSelectedNodeFormState",value:function(e,t){this.selectedNodeFormState={error:e,selectedNode:t},this.onSelectedNodeFormStateChanged(this.selectedNodeFormState)}},{key:"_updateSelectedNodeFormState",value:function(){var e=this,t=j.getSelectedNodeId();void 0!==t?l.getNode(t).then((function(t){e._setSelectedNodeFormState(void 0,t)})).catch((function(t){e._setSelectedNodeFormState(t,void 0)})):this._setSelectedNodeFormState(void 0,void 0)}},{key:"onUIPanelStateChanged",value:function(e){}},{key:"_setUIPanelState",value:function(e){this.uiPanelState={selectedNodeId:e},this.onUIPanelStateChanged(this.uiPanelState)}},{key:"_updateUIPanelState",value:function(){var e=j.getSelectedNodeId();this._setUIPanelState(e)}},{key:"onPopupEditorStateChanged",value:function(e){}},{key:"_setPopupEditorState",value:function(e,t,n){this.popupEditorState={visible:e,event:t,node:n},this.onPopupEditorStateChanged(this.popupEditorState)}},{key:"_updatePopupEditorState",value:function(){this._setPopupEditorState(!1)}}]),e}()),_=n(0);function k(e){var t,n=e.treeNode,d=n.id,r=n.name,o=n.expanded,i=n.selected,a=n.children,c=e.handler;return a&&(t=a.map((function(e){return Object(_.jsx)(k,{treeNode:e,handler:c},e.id)}))),Object(_.jsxs)("div",{children:[Object(_.jsxs)("div",{className:"TreeItem"+(i?" selected":""),children:[Object(_.jsx)("button",{onClick:function(){c(v,d)},children:o?"-":"+"}),Object(_.jsxs)("div",{className:"TreeItem-name",onClick:function(){c(p,d)},children:[r,"(",i?"*":".",")"]})]}),Object(_.jsx)("div",{className:"TreeItem-children",children:t})]})}function C(e){var t=e.treeRootState,n=t.error,d=t.isLoading,r=t.treeNodes,o=e.handler,i=Object(_.jsx)("div",{children:"..."});return i=d?Object(_.jsx)("div",{children:"Loading..."}):n?Object(_.jsx)("div",{children:n.toString()}):r.map((function(e){return Object(_.jsx)(k,{treeNode:e,handler:o},e.id)})),Object(_.jsx)("div",{className:"form-container",children:i})}function I(e){var t=e.allNodesTableState,n=t.error,d=t.isLoading,r=t.nodes,o=e.handler,i=Object(_.jsx)("div",{children:"..."});return i=d?Object(_.jsx)("div",{children:"Loading..."}):n?Object(_.jsx)("div",{children:n.toString()}):Object(_.jsxs)("table",{children:[Object(_.jsx)("thead",{children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{children:"id"}),Object(_.jsx)("th",{children:"parentId"}),Object(_.jsx)("th",{children:"name"}),Object(_.jsx)("th",{children:"ip"}),Object(_.jsx)("th",{children:"port"})]})}),Object(_.jsx)("tbody",{children:r.map((function(e){return Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:e.id}),Object(_.jsx)("td",{children:e.parentId}),Object(_.jsx)("td",{children:e.name}),Object(_.jsx)("td",{children:e.ip}),Object(_.jsx)("td",{children:e.port})]},e.id)}))})]}),Object(_.jsxs)("div",{className:"form-container",children:[Object(_.jsx)("button",{onClick:function(){return o(b)},children:"Refresh"}),i]})}function T(e){var t=e.selectedNodeFormState,n=t.error,d=t.selectedNode,r=Object(_.jsx)("div",{children:"..."});return r=n?Object(_.jsx)("div",{children:n.toString()}):void 0===d?Object(_.jsx)("div",{children:"no selection"}):Object(_.jsx)("table",{children:Object(_.jsxs)("tbody",{children:[Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"id"}),Object(_.jsx)("td",{children:d.id})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"parentId"}),Object(_.jsx)("td",{children:d.parentId})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"name"}),Object(_.jsx)("td",{children:d.name})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"ip"}),Object(_.jsx)("td",{children:d.ip})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"port"}),Object(_.jsx)("td",{children:d.port})]})]})}),Object(_.jsx)("div",{className:"form-container",children:r})}function y(e){var t=e.uiPanelState.selectedNodeId,n=e.handler,d=void 0===t;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("button",{onClick:function(){return n(O)},className:"UIPanelContainer_child",children:"Add root node"}),Object(_.jsx)("button",{onClick:function(){return n(S,t)},className:"UIPanelContainer_child",disabled:d,children:"Add child"}),Object(_.jsx)("button",{onClick:function(){return n(x,t)},className:"UIPanelContainer_child",disabled:d,children:"Edit"}),Object(_.jsx)("button",{onClick:function(){return n(f,t)},className:"UIPanelContainer_child",disabled:d,children:"Delete"}),Object(_.jsxs)("div",{className:"UIPanelContainer_child",children:["selected node id=",t]})]})}var P=n(6);function E(e,t){return void 0===e||null===e?t:e}function R(e){return"null"===e||""===e?null:e}function A(e){var t=e.popupEditorState.node,n=e.handler,d=r.a.useState((function(){return function(e){return{id:E(e.id,"null"),parentId:E(e.parentId,"null"),name:E(e.name,"node name"),ip:E(e.ip,"0.0.0.0"),port:E(e.port,"0")}}(t)})),o=Object(a.a)(d,2),i=o[0],c=o[1];function s(e){var t=e.target,n=t.name,d=t.value;c(Object(u.a)(Object(u.a)({},i),{},Object(P.a)({},n,d)))}return Object(_.jsx)("div",{className:"PopupEditor",children:Object(_.jsxs)("div",{className:"form-container PopupEditor-content",children:[Object(_.jsx)("table",{children:Object(_.jsxs)("tbody",{children:[Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"id"}),Object(_.jsx)("td",{children:Object(_.jsx)("input",{name:"id",value:i.id,disabled:!0,onChange:s})})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"parentId"}),Object(_.jsx)("td",{children:Object(_.jsx)("input",{name:"parentId",value:i.parentId,disabled:!0,onChange:s})})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"name"}),Object(_.jsx)("td",{children:Object(_.jsx)("input",{name:"name",value:i.name,onChange:s})})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"ip"}),Object(_.jsx)("td",{children:Object(_.jsx)("input",{name:"ip",value:i.ip,onChange:s})})]}),Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:"port"}),Object(_.jsx)("td",{children:Object(_.jsx)("input",{name:"port",value:i.port,onChange:s})})]})]})}),Object(_.jsxs)("div",{className:"PopupEditor-ui",children:[Object(_.jsx)("button",{onClick:function(){return n(N,function(e){return{id:R(e.id),parentId:R(e.parentId),name:R(e.name),ip:R(e.ip),port:R(e.port)}}(i))},className:"UIPanelContainer_child",children:"Save"}),Object(_.jsx)("button",{onClick:function(){return n(m)},className:"UIPanelContainer_child",children:"Cancel"})]})]})})}var F=function(){var e=r.a.useState(g.treeRootState),t=Object(a.a)(e,2),n=t[0],d=t[1];g.onTreeRootStateChanged=d;var o=r.a.useState(g.allNodesTableState),i=Object(a.a)(o,2),c=i[0],s=i[1];g.onAllNodesTableStateChanged=s;var l=r.a.useState(g.selectedNodeFormState),h=Object(a.a)(l,2),u=h[0],j=h[1];g.onSelectedNodeFormStateChanged=j;var b=r.a.useState(g.uiPanelState),p=Object(a.a)(b,2),v=p[0],O=p[1];g.onUIPanelStateChanged=O;var S=r.a.useState(g.popupEditorState),x=Object(a.a)(S,2),f=x[0],N=x[1];return g.onPopupEditorStateChanged=N,Object(_.jsxs)("div",{className:"App",children:[Object(_.jsx)("h1",{children:"Client React Tree"}),Object(_.jsxs)("div",{className:"TreeAndSelectionContainer",children:[Object(_.jsxs)("div",{className:"TreeAndSelectionContainer_child",children:[Object(_.jsx)("b",{children:"Tree:"}),Object(_.jsx)(C,{treeRootState:n,handler:g.getHandler()})]}),Object(_.jsxs)("div",{className:"TreeAndSelectionContainer_child",children:[Object(_.jsx)("b",{children:"Selected:"}),Object(_.jsx)(T,{selectedNodeFormState:u})]})]}),Object(_.jsx)("br",{}),Object(_.jsx)("div",{className:"UIPanelContainer form-container",children:Object(_.jsx)(y,{uiPanelState:v,handler:g.getHandler()})}),Object(_.jsx)("br",{}),Object(_.jsx)("b",{children:"All nodes:"}),Object(_.jsx)(I,{allNodesTableState:c,handler:g.getHandler()}),f.visible?Object(_.jsx)(A,{popupEditorState:f,handler:g.getHandler()}):null]})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,d=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),d(e),r(e),o(e),i(e)}))};i.a.render(Object(_.jsx)(r.a.StrictMode,{children:Object(_.jsx)(F,{})}),document.getElementById("root")),U()}},[[17,1,2]]]);
//# sourceMappingURL=main.14e1890a.chunk.js.map